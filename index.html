<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Vite + TS</title>
  <script type="module" crossorigin>var v=e=>{throw TypeError(e)};var P=(e,t,o)=>t.has(e)||v("Cannot "+o);var s=(e,t,o)=>(P(e,t,"read from private field"),o?o.call(e):t.get(e)),f=(e,t,o)=>t.has(e)?v("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,o),h=(e,t,o,c)=>(P(e,t,"write to private field"),c?c.call(e,o):t.set(e,o),o);(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))c(i);new MutationObserver(i=>{for(const r of i)if(r.type==="childList")for(const b of r.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&c(b)}).observe(document,{childList:!0,subtree:!0});function o(i){const r={};return i.integrity&&(r.integrity=i.integrity),i.referrerPolicy&&(r.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?r.credentials="include":i.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(i){if(i.ep)return;i.ep=!0;const r=o(i);fetch(i.href,r)}})();function O(e,t={},...o){const c=document.createElement(e);for(const[i,r]of Object.entries(t))c.setAttribute(i,r);for(const i of o)typeof i=="string"?c.appendChild(document.createTextNode(i)):c.appendChild(i);return c}var n=(e=>(e[e.Tempo=0]="Tempo",e[e.Note=1]="Note",e))(n||{}),g=(e=>(e[e.Tempo=0]="Tempo",e[e.NoteOn=1]="NoteOn",e[e.NoteOff=2]="NoteOff",e))(g||{});const E=(e,t)=>{const o=[];function c(a){return{position:a.position,type:g.Tempo,bpm:a.bpm}}function i(a){const N={position:a.position,type:g.NoteOn,pitch:a.pitch},k={position:a.position+a.duration-.1,type:g.NoteOff,pitch:a.pitch};return[N,k]}for(const a of t)switch(a.type){case n.Tempo:o.push(c(a));break;case n.Note:o.push(...i(a));break;default:throw new Error("Invalid event type")}function r(a){return a.sort((N,k)=>N.position-k.position)}return r(o)},x={title:"Bass Scale",parts:{bass:{script:E,score:[{position:-1/0,type:n.Tempo,bpm:120},{position:0,type:n.Note,pitch:36,duration:1},{position:1,type:n.Note,pitch:38,duration:1},{position:2,type:n.Note,pitch:40,duration:1},{position:3,type:n.Note,pitch:41,duration:1},{position:4,type:n.Note,pitch:43,duration:1},{position:5,type:n.Note,pitch:45,duration:1},{position:6,type:n.Note,pitch:47,duration:1},{position:7,type:n.Note,pitch:48,duration:1}]}}},C={title:"Lead Scale",parts:{lead:{script:E,score:[{position:-1/0,type:n.Tempo,bpm:60},{position:0,type:n.Note,pitch:60,duration:1},{position:1,type:n.Note,pitch:62,duration:1},{position:2,type:n.Note,pitch:64,duration:1},{position:3,type:n.Note,pitch:65,duration:1},{position:4,type:n.Note,pitch:67,duration:1},{position:5,type:n.Note,pitch:69,duration:1},{position:6,type:n.Note,pitch:71,duration:1},{position:7,type:n.Note,pitch:72,duration:1}]}}},T=[x,C],w="#transporter",I=[["previous","⏮"],["play","▶"],["pause","⏸"],["stop","⏹"],["next","⏭"]],S=([e,t])=>[e,O("button",{},t)],j=()=>Object.fromEntries(I.map(S)),A={0:{play:!0,pause:!1,stop:!1},1:{play:!1,pause:!0,stop:!1},2:{play:!1,pause:!0,stop:!0}};var m,p;class q{constructor(){f(this,m,O("h2"));f(this,p,j());const t=document.querySelector(w);if(!t)throw new Error(`Transporter not found: ${w}`);const o=O("div",{},...Object.values(s(this,p)));t==null||t.append(s(this,m),o)}changeChart(t,o,c){s(this,m).innerText=t,s(this,p).previous.disabled=!o,s(this,p).next.disabled=!c}changePlayback(t){for(const[o,c]of Object.entries(A[t]))s(this,p)[o].disabled=c}connect(t,o){s(this,p).previous.addEventListener("click",()=>t.goPrevious()),s(this,p).next.addEventListener("click",()=>t.goNext()),s(this,p).play.addEventListener("click",()=>o.play()),s(this,p).pause.addEventListener("click",()=>o.pause()),s(this,p).stop.addEventListener("click",()=>o.stop())}}m=new WeakMap,p=new WeakMap;const L=T.length;var u,y;class B{constructor(){f(this,u,0);f(this,y,()=>{})}goPrevious(){s(this,u)>0&&(h(this,u,s(this,u)-1),s(this,y).call(this))}goNext(){s(this,u)<L-1&&(h(this,u,s(this,u)+1),s(this,y).call(this))}connect(t,o){h(this,y,()=>{const c=T[s(this,u)],i=c.title,r=s(this,u)>0,b=s(this,u)<L-1;t.changeChart(i,r,b),o.changeChart(c)})}start(){s(this,y).call(this)}}u=new WeakMap,y=new WeakMap;var l,d;class D{constructor(){f(this,l,1);f(this,d,()=>{})}changeChart(t){console.log("changeChart",t),s(this,l)!=2&&this.stop()}play(){switch(s(this,l)){case 0:console.log("already playing");break;case 1:s(this,d).call(this,2),console.log("resume"),h(this,l,0);break;case 2:s(this,d).call(this,0),console.log("play"),h(this,l,0);break}}pause(){switch(s(this,l)){case 0:s(this,d).call(this,1),console.log("pause"),h(this,l,1);break;case 1:console.log("already paused");break;case 2:console.log("already stopped");break}}stop(){switch(s(this,l)){case 0:s(this,d).call(this,3),console.log("stop"),h(this,l,2);break;case 1:s(this,d).call(this,3),console.log("stop"),h(this,l,2);break;case 2:console.log("already stopped");break}}connect(t){h(this,d,o=>{switch(o){case 0:t.changePlayback(0);break;case 1:t.changePlayback(1);break;case 2:t.changePlayback(0);break;case 3:t.changePlayback(2);break}})}}l=new WeakMap,d=new WeakMap;function _(){const e=new q,t=new B,o=new D;e.connect(t,o),t.connect(e,o),o.connect(e),t.start()}_();
</script>
  <style rel="stylesheet" crossorigin>:root{--red: #b23535;--green: #38ad5f;--blue: #464ca5;--white: #eeeade;--black: #282828;--text-color: var(--black);--background-color: var(--white)}@media (prefers-color-scheme: dark){:root{--text-color: var(--white);--background-color: var(--black)}}*{color:inherit;background-color:inherit;font-family:inherit}body{min-height:100vh;font-family:Arial,sans-serif;color:var(--text-color);background-color:var(--background-color);border-color:var(--text-color)}
</style>
</head>

<body>
  <div id="transporter"></div>
</body>

</html>